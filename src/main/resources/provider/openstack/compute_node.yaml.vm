#parse("provider/common/generic_resource.yaml.vm")
#foreach($compute in ${deployment.computes})
#providerResourceNode(${compute.nodeTemplate.type}, $compute)
#set( $publicNetworks = ${util.network.getExternalNetworks($compute)} )
#set( $privateNetworks = ${util.network.getPrivateNetworks($compute)} )
#if($util.collectionHasElement(${publicNetworks}) || $util.collectionHasElement(${privateNetworks}))
    relationships:
#foreach($internalNetwork in ${util.network.getInternalNetworks($compute)})
      - target: ${internalNetwork.id}
        type: cloudify.relationships.connected_to
      - target: ${internalNetwork.id}_subnet
        type: cloudify.relationships.depends_on
#end
#foreach($externalNetwork in ${util.network.getExternalNetworks($compute)})
      - target: ${mapping.generatedNodePrefix}_floating_ip_${compute.id}_on_${externalNetwork.id}
        type: ${util.network.getNativePropertyValue(${externalNetwork.indexedToscaElement}, "_a4c_floating_ip_relationship_mapped_to")}
  ${mapping.generatedNodePrefix}_floating_ip_${compute.id}_on_${externalNetwork.id}:
    type: ${externalNetwork.type}
    properties: ${util.common.formatProperties(3, $externalNetwork.nodeTemplate.properties)}
#end
#end
#end